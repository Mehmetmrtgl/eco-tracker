generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model accounts {
  id                       String         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id                  String?        @db.Uuid
  name                     String         @db.VarChar(50)
  type                     String         @db.VarChar(20)
  currency                 String?        @default("TRY") @db.VarChar(3)
  balance                  Decimal?       @default(0.00) @db.Decimal(15, 2)
  is_included_in_net_worth Boolean?       @default(true)
  created_at               DateTime?      @default(now()) @db.Timestamptz(6)
  users                    users?         @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  transactions             transactions[]
}

model asset_transactions {
  id               String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id          String?   @db.Uuid
  asset_id         String?   @db.Uuid
  type             String    @db.VarChar(10)
  quantity         Decimal   @db.Decimal(15, 5)
  price_per_unit   Decimal   @db.Decimal(15, 2)
  total_price      Decimal   @db.Decimal(15, 2)
  transaction_date DateTime? @default(now()) @db.Timestamptz(6)
  assets           assets?   @relation(fields: [asset_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users            users?    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model assets {
  id                 String               @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id            String?              @db.Uuid
  name               String               @db.VarChar(50)
  type               String               @db.VarChar(20)
  symbol             String               @db.VarChar(20)
  quantity           Decimal              @default(0) @db.Decimal(15, 5)
  avg_cost           Decimal              @default(0) @db.Decimal(15, 2)
  current_value      Decimal?             @db.Decimal(15, 2)
  updated_at         DateTime?            @default(now()) @db.Timestamptz(6)
  asset_transactions asset_transactions[]
  users              users?               @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model categories {
  id           String         @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id      String?        @db.Uuid
  name         String         @db.VarChar(50)
  type         String         @db.VarChar(10)
  icon         String?        @db.VarChar(50)
  is_default   Boolean?       @default(false)
  users        users?         @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  transactions transactions[]
}

model debts {
  id               String    @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id          String?   @db.Uuid
  title            String    @db.VarChar(100)
  total_amount     Decimal   @db.Decimal(15, 2)
  remaining_amount Decimal   @db.Decimal(15, 2)
  due_date         DateTime? @db.Date
  type             String?   @default("LOAN") @db.VarChar(20)
  is_closed        Boolean?  @default(false)
  created_at       DateTime? @default(now()) @db.Timestamptz(6)
  users            users?    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model transactions {
  id               String      @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  user_id          String?     @db.Uuid
  account_id       String?     @db.Uuid
  category_id      String?     @db.Uuid
  type             String      @db.VarChar(10)
  amount           Decimal     @db.Decimal(15, 2)
  description      String?
  transaction_date DateTime?   @default(dbgenerated("CURRENT_DATE")) @db.Date
  created_at       DateTime?   @default(now()) @db.Timestamptz(6)
  accounts         accounts?   @relation(fields: [account_id], references: [id], onUpdate: NoAction)
  categories       categories? @relation(fields: [category_id], references: [id], onUpdate: NoAction)
  users            users?      @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model users {
  id                 String               @id @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  email              String               @unique @db.VarChar(255)
  password_hash      String               @db.VarChar(255)
  full_name          String?              @db.VarChar(100)
  created_at         DateTime?            @default(now()) @db.Timestamptz(6)
  updated_at         DateTime?            @default(now()) @db.Timestamptz(6)
  accounts           accounts[]
  asset_transactions asset_transactions[]
  assets             assets[]
  categories         categories[]
  debts              debts[]
  transactions       transactions[]
}
